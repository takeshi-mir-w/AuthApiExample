# AuthApiExample

本サンプルでは、以下の層に分割しています。

---

## ドメイン層

- **責務**  
  ビジネスルールやシステムのコアとなる概念（エンティティ）を定義します。

- **具体例**
    - ユーザーを表すエンティティ（例：`User`）
    - ドメイン固有のルールや振る舞い（例：値の検証、状態の遷移）
    - リポジトリの抽象（trait）  
      ここでデータの取得や保存のインターフェースを定義し、詳細な実装は隠蔽します。

- **ポイント**
    - **外部依存の排除**  
      ドメイン層は外部の技術的な実装（データベース、Webサーバなど）に依存しない、純粋なビジネスロジックのみを扱います。
    - **安定性**  
      システムの中心部として、変更の影響を受けにくい設計を目指します。

---

## ユースケース層（アプリケーション層）

- **責務**  
  ドメイン層のエンティティやリポジトリの抽象を利用し、具体的な業務シナリオや処理（ユースケース）を実現します。

- **具体例**
    - `UserService`  
      ユーザーの取得や作成といったケースに沿って、必要な処理の流れをオーケストレーションします。

- **ポイント**
    - **事務的な処理の実行**  
      ユースケース層は入力値の検証や加工、エラーハンドリング、DTO（データ転送オブジェクト）への変換などを担います。
    - **層間の橋渡し**  
      ドメイン層（ビジネスルール）とインフラ層（技術実装）を接続し、システム全体のビジネスシナリオを具体的に実行する役割を果たします。

---

## インフラ層

- **責務**  
  外部システムや技術的な実装の詳細（データベースアクセス、Webサーバ、外部APIなど）を担当します。

- **具体例**
    - **Webサーバ**: http4s を使って HTTP リクエストのルーティングやサーバの起動を行う  
      例：`UserRoutes` など
    - **リポジトリ実装**: ドメイン層で定義した `UserRepository` の具体的な実装  
      例：`InMemoryUserRepository`（メモリ上で管理する実装のサンプル）

- **ポイント**
    - **技術的な依存の隔離**  
      この層で外部ライブラリやフレームワークに依存する実装を行い、ドメインやユースケース層はそれらに依存しません。
    - **変更の局所化**  
      データベースやネットワークなどの外部技術に変更があった場合は、インフラ層のみを調整すればよいように設計します。

---

## まとめ

- **ドメイン層**  
  ビジネスルールやエンティティ、共通概念を定義し、外部技術に依存しないコア部分を担います。

- **ユースケース層（アプリケーション層）**  
  ドメイン層の抽象を元に具体的な業務シナリオを実装し、入力の検証やデータの整形、エラーハンドリングを行います。

- **インフラ層**  
  外部システムとの連携、Webサーバの運用、データ永続化などの技術的な詳細実装を担当し、システムの周辺領域として機能します。
- 